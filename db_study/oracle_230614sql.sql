DROP SEQUENCE NUM_SEQ;

CREATE SEQUENCE NUM_SEQ;
DROP TABLE TBL_TEACHER_202201;
CREATE TABLE TBL_TEACHER_202201( --강사정보
    TEACHER_CODE CHAR(3) NOT NULL PRIMARY KEY, --강사코드
    TEACHER_NAME VARCHAR2(15), --강사명
    CLASS_NAME VARCHAR2(20), --강의명
    CLASS_PRICE NUMBER(8), --수강료
    TEACHER_REGIST_DATE VARCHAR2(8) --강사자격취득일
);

SELECT * FROM TBL_TEACHER_202201;

INSERT INTO TBL_TEACHER_202201 VALUES ('100', '이초급', '초급반', 100000, '20220101');
INSERT INTO TBL_TEACHER_202201 VALUES ('200', '김중급', '중급반', 200000, '20220102');
INSERT INTO TBL_TEACHER_202201 VALUES ('300', '박고급', '고급반', 300000, '20220103');
INSERT INTO TBL_TEACHER_202201 VALUES ('400', '정심화', '심화반', 400000, '20220104');

COMMIT;

CREATE TABLE TBL_MEMBER_202201( --회원정보테이블
    C_NO CHAR(5) NOT NULL PRIMARY KEY, -- 회원번호
    C_NAME VARCHAR2(15), -- 회원명
    PHONE VARCHAR2(11), -- 전화번호
    ADDRESS VARCHAR2(50), -- 주소
    GRADE VARCHAR2(6) -- 등급
);

SELECT * FROM TBL_MEMBER_202201;

INSERT INTO TBL_MEMBER_202201 VALUES ('10001', '홍길동', '01011112222', '서울시 강남구', '일반');
INSERT INTO TBL_MEMBER_202201 VALUES ('10002', '장발장', '01022223333', '성남시 분당구', '일반');
INSERT INTO TBL_MEMBER_202201 VALUES ('10003', '임꺽정', '01033334444', '대전시 유성구', '일반');
INSERT INTO TBL_MEMBER_202201 VALUES ('10004', '성춘향', '01044445555', '부산시 서구', 'VIP');
INSERT INTO TBL_MEMBER_202201 VALUES ('10005', '이몽룡', '01055556666', '대구시 북구', 'VIP');

CREATE TABLE TBL_CLASS_202201( --수강정보
    REGIST_MONTH VARCHAR2(6) NOT NULL, -- 수강월
    C_NO CHAR(5) NOT NULL, -- 회원번호
    CLASS_AREA VARCHAR2(15), -- 강의장소
    TUITION NUMBER(8), -- 수강료
    TEACHER_CODE CHAR(3), -- 강사코드
    PRIMARY KEY(REGIST_MONTH, C_NO)
);

DROP TABLE TBL_CLASS_202201;

SELECT * FROM TBL_CLASS_202201;

INSERT INTO TBL_CLASS_202201 VALUES ('202203', '10001', '서울본원', 100000, '100');
INSERT INTO TBL_CLASS_202201 VALUES ('202203', '10002', '성남분원', 100000, '100');
INSERT INTO TBL_CLASS_202201 VALUES ('202203', '10003', '대전분원', 200000, '200');
INSERT INTO TBL_CLASS_202201 VALUES ('202203', '10004', '부산분원', 150000, '300');
INSERT INTO TBL_CLASS_202201 VALUES ('202203', '10005', '대구분원', 200000, '400');

COMMIT;

-- 회원정보조회 쿼리
select c.regist_month, m.c_no, m.c_name, t.class_name, c.class_area, c.tuition, m.grade
from tbl_teacher_202201 T, tbl_member_202201 M, tbl_class_202201 C
where T.teacher_code = C.teacher_code and C.c_no = M.c_no;

-- 강사매출현황
SELECT tt.TEACHER_CODE, tt.CLASS_NAME, tt.TEACHER_NAME, SUM(tc.TUITION) TUITION FROM TBL_TEACHER_202201 tt, TBL_CLASS_202201 tc
WHERE tt.TEACHER_CODE = tc.TEACHER_CODE GROUP BY tt.TEACHER_CODE, tt.CLASS_NAME, tt.TEACHER_NAME ORDER BY tt.TEACHER_CODE ASC;